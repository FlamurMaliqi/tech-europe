{
  "vulnerability_lab": {
    "name": "McDonald's Drive-Thru Vulnerability Lab",
    "version": "1.0.0",
    "description": "Intentionally vulnerable application for educational purposes",
    "warning": "DO NOT USE IN PRODUCTION - FOR EDUCATIONAL PURPOSES ONLY",
    "vulnerabilities": [
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "149",
        "vuln_type": "SQL Injection",
        "severity_hint": "high",
        "note": "VULNERABLE: Direct string concatenation into SQL query"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "454",
        "vuln_type": "Reflected XSS",
        "severity_hint": "medium",
        "note": "VULNERABLE: No input sanitization or output encoding"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "484",
        "vuln_type": "Insecure Deserialization",
        "severity_hint": "critical",
        "note": "VULNERABLE: Using pickle for deserialization without validation"
      },
      {
        "file": "agent/drive_thru/vulnerable_crypto.py",
        "line_hint": "25",
        "vuln_type": "Weak Crypto",
        "severity_hint": "high",
        "note": "VULNERABLE: MD5 password hashing - cryptographically broken"
      },
      {
        "file": "agent/drive_thru/vulnerable_crypto.py",
        "line_hint": "35",
        "vuln_type": "Weak Crypto",
        "severity_hint": "high",
        "note": "VULNERABLE: DES encryption with weak 56-bit key"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "385",
        "vuln_type": "Missing Authentication",
        "severity_hint": "high",
        "note": "VULNERABLE: No authentication required for admin functions"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "417",
        "vuln_type": "IDOR",
        "severity_hint": "medium",
        "note": "VULNERABLE: No authorization check - users can access any user's data"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "587",
        "vuln_type": "IDOR",
        "severity_hint": "medium",
        "note": "VULNERABLE: No authorization check - users can access any order"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "42",
        "vuln_type": "Missing Security Headers",
        "severity_hint": "medium",
        "note": "VULNERABLE: No Content Security Policy, X-Frame-Options, etc."
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "481",
        "vuln_type": "Secrets in Logs",
        "severity_hint": "high",
        "note": "VULNERABLE: Logging sensitive data in plaintext"
      },
      {
        "file": "agent/drive_thru/data_pipeline.py",
        "line_hint": "40",
        "vuln_type": "Secrets in Logs",
        "severity_hint": "high",
        "note": "VULNERABLE: Logging sensitive environment variables"
      },
      {
        "file": "agent/drive_thru/vulnerable_secrets.py",
        "line_hint": "8",
        "vuln_type": "Hardcoded Secrets",
        "severity_hint": "critical",
        "note": "VULNERABLE: Hardcoded secrets in source code"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "422",
        "vuln_type": "Secrets Exposure",
        "severity_hint": "critical",
        "note": "VULNERABLE: Exposing all secrets in debug endpoint"
      },
      {
        "file": "agent/requirements-vulnerable.txt",
        "line_hint": "1",
        "vuln_type": "Vulnerable Dependencies",
        "severity_hint": "high",
        "note": "VULNERABLE: Packages with known CVEs"
      },
      {
        "file": "dashboard/package-vulnerable.json",
        "line_hint": "16",
        "vuln_type": "Vulnerable Dependencies",
        "severity_hint": "high",
        "note": "VULNERABLE: Frontend packages with known CVEs"
      },
      {
        "file": "Dockerfile.vuln-lab",
        "line_hint": "4",
        "vuln_type": "Container Security",
        "severity_hint": "high",
        "note": "VULNERABLE: Running as root user"
      },
      {
        "file": "Dockerfile.vuln-lab",
        "line_hint": "1",
        "vuln_type": "Container Security",
        "severity_hint": "medium",
        "note": "VULNERABLE: Using old base image with known vulnerabilities"
      },
      {
        "file": "k8s-vulnerable.yaml",
        "line_hint": "25",
        "vuln_type": "CSPM",
        "severity_hint": "critical",
        "note": "VULNERABLE: Overly permissive ClusterRole with full access"
      },
      {
        "file": "k8s-vulnerable.yaml",
        "line_hint": "45",
        "vuln_type": "CSPM",
        "severity_hint": "high",
        "note": "VULNERABLE: Running containers with privileged access"
      },
      {
        "file": "terraform-vulnerable.tf",
        "line_hint": "25",
        "vuln_type": "CSPM",
        "severity_hint": "high",
        "note": "VULNERABLE: S3 bucket with public read access"
      },
      {
        "file": "terraform-vulnerable.tf",
        "line_hint": "45",
        "vuln_type": "CSPM",
        "severity_hint": "critical",
        "note": "VULNERABLE: Security group allowing all traffic"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "676",
        "vuln_type": "Command Injection",
        "severity_hint": "critical",
        "note": "VULNERABLE: Direct execution of user input without sanitization"
      },
      {
        "file": "agent/drive_thru/api.py",
        "line_hint": "701",
        "vuln_type": "Unsafe eval()",
        "severity_hint": "critical",
        "note": "VULNERABLE: Using eval() with user input allowing arbitrary code execution"
      },
      {
        "file": ".github/workflows/vulnerable-ci.yml",
        "line_hint": "25",
        "vuln_type": "Supply Chain - CI/CD",
        "severity_hint": "high",
        "note": "VULNERABLE: CI pipeline without checksum verification and security scanning"
      },
      {
        "file": "scripts/vulnerable-build.sh",
        "line_hint": "8",
        "vuln_type": "Supply Chain - Build",
        "severity_hint": "high",
        "note": "VULNERABLE: Build script fetching and executing remote scripts without verification"
      }
    ],
    "categories": {
      "SAST": [
        "SQL Injection",
        "Reflected XSS",
        "Insecure Deserialization",
        "Command Injection",
        "Unsafe eval()",
        "Weak Crypto",
        "Hardcoded Secrets"
      ],
      "DAST": [
        "Missing Authentication",
        "IDOR",
        "Missing Security Headers",
        "CORS Wide-Open",
        "Weak Session Management"
      ],
      "SCA": [
        "Vulnerable Dependencies"
      ],
      "Secrets": [
        "Secrets in Logs",
        "Secrets Exposure",
        "Hardcoded Secrets"
      ],
      "CSPM": [
        "Container Security",
        "Overly Permissive IAM",
        "Public Resources",
        "Missing Network Security"
      ],
      "Runtime": [
        "Debug Endpoints",
        "Privileged Containers",
        "Host Access"
      ],
      "Supply Chain": [
        "CI/CD Vulnerabilities",
        "Build Script Vulnerabilities"
      ]
    },
    "scanner_mapping": {
      "Aikido": {
        "SAST": "Static Application Security Testing",
        "DAST": "Dynamic Application Security Testing",
        "SCA": "Software Composition Analysis",
        "Secrets": "Secrets Scanning",
        "CSPM": "Cloud Security Posture Management",
        "Runtime": "Runtime Security Monitoring"
      }
    }
  }
}
