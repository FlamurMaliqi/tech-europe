{
  "vulnerability_lab": {
    "name": "McDonald's Drive-Thru Vulnerability Lab",
    "version": "1.0.0",
    "description": "Intentionally vulnerable application for educational purposes",
    "warning": "DO NOT USE IN PRODUCTION - FOR EDUCATIONAL PURPOSES ONLY",
    "vulnerabilities": [
      {
        "file": "agent/drive_thru/cve_packages/sql_injection/sql_injection_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "SQL Injection",
        "severity_hint": "high",
        "note": "VULNERABLE: Direct string concatenation into SQL query",
        "cve_id": "CVE-2024-0001"
      },
      {
        "file": "agent/drive_thru/cve_packages/xss/xss_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Reflected XSS",
        "severity_hint": "medium",
        "note": "VULNERABLE: No input sanitization or output encoding",
        "cve_id": "CVE-2024-0002"
      },
      {
        "file": "agent/drive_thru/cve_packages/insecure_deserialization/insecure_deserialization_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Insecure Deserialization",
        "severity_hint": "critical",
        "note": "VULNERABLE: Using pickle for deserialization without validation",
        "cve_id": "CVE-2024-0003"
      },
      {
        "file": "agent/drive_thru/cve_packages/weak_crypto_md5/md5_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Weak Crypto - MD5",
        "severity_hint": "high",
        "note": "VULNERABLE: MD5 password hashing - cryptographically broken",
        "cve_id": "CVE-2024-0004"
      },
      {
        "file": "agent/drive_thru/cve_packages/weak_crypto_des/des_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Weak Crypto - DES",
        "severity_hint": "high",
        "note": "VULNERABLE: DES encryption with weak 56-bit key",
        "cve_id": "CVE-2024-0005"
      },
      {
        "file": "agent/drive_thru/cve_packages/missing_authentication/missing_auth_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Missing Authentication",
        "severity_hint": "high",
        "note": "VULNERABLE: No authentication required for admin functions",
        "cve_id": "CVE-2024-0006"
      },
      {
        "file": "agent/drive_thru/cve_packages/idor/idor_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "IDOR",
        "severity_hint": "medium",
        "note": "VULNERABLE: No authorization check - users can access any user's data",
        "cve_id": "CVE-2024-0007"
      },
      {
        "file": "agent/drive_thru/cve_packages/command_injection/command_injection_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Command Injection",
        "severity_hint": "critical",
        "note": "VULNERABLE: Direct execution of user input without sanitization",
        "cve_id": "CVE-2024-0008"
      },
      {
        "file": "agent/drive_thru/cve_packages/unsafe_eval/unsafe_eval_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Unsafe eval()",
        "severity_hint": "critical",
        "note": "VULNERABLE: Using eval() with user input allowing arbitrary code execution",
        "cve_id": "CVE-2024-0009"
      },
      {
        "file": "agent/drive_thru/cve_packages/hardcoded_secrets/hardcoded_secrets_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Hardcoded Secrets",
        "severity_hint": "critical",
        "note": "VULNERABLE: Hardcoded secrets in source code",
        "cve_id": "CVE-2024-0010"
      },
      {
        "file": "agent/drive_thru/cve_packages/secrets_exposure/secrets_exposure_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Secrets Exposure",
        "severity_hint": "critical",
        "note": "VULNERABLE: Exposing all secrets in debug endpoint",
        "cve_id": "CVE-2024-0011"
      },
      {
        "file": "agent/drive_thru/cve_packages/missing_security_headers/missing_security_headers_vulnerability.py",
        "line_hint": "25",
        "vuln_type": "Missing Security Headers",
        "severity_hint": "medium",
        "note": "VULNERABLE: No Content Security Policy, X-Frame-Options, etc.",
        "cve_id": "CVE-2024-0012"
      },
      {
        "file": "agent/requirements-vulnerable.txt",
        "line_hint": "1",
        "vuln_type": "Vulnerable Dependencies",
        "severity_hint": "high",
        "note": "VULNERABLE: Packages with known CVEs"
      },
      {
        "file": "dashboard/package-vulnerable.json",
        "line_hint": "16",
        "vuln_type": "Vulnerable Dependencies",
        "severity_hint": "high",
        "note": "VULNERABLE: Frontend packages with known CVEs"
      },
      {
        "file": "Dockerfile.vuln-lab",
        "line_hint": "4",
        "vuln_type": "Container Security",
        "severity_hint": "high",
        "note": "VULNERABLE: Running as root user"
      },
      {
        "file": "Dockerfile.vuln-lab",
        "line_hint": "1",
        "vuln_type": "Container Security",
        "severity_hint": "medium",
        "note": "VULNERABLE: Using old base image with known vulnerabilities"
      },
      {
        "file": "k8s-vulnerable.yaml",
        "line_hint": "25",
        "vuln_type": "CSPM",
        "severity_hint": "critical",
        "note": "VULNERABLE: Overly permissive ClusterRole with full access"
      },
      {
        "file": "k8s-vulnerable.yaml",
        "line_hint": "45",
        "vuln_type": "CSPM",
        "severity_hint": "high",
        "note": "VULNERABLE: Running containers with privileged access"
      },
      {
        "file": "terraform-vulnerable.tf",
        "line_hint": "25",
        "vuln_type": "CSPM",
        "severity_hint": "high",
        "note": "VULNERABLE: S3 bucket with public read access"
      },
      {
        "file": "terraform-vulnerable.tf",
        "line_hint": "45",
        "vuln_type": "CSPM",
        "severity_hint": "critical",
        "note": "VULNERABLE: Security group allowing all traffic"
      },
      {
        "file": ".github/workflows/vulnerable-ci.yml",
        "line_hint": "25",
        "vuln_type": "Supply Chain - CI/CD",
        "severity_hint": "high",
        "note": "VULNERABLE: CI pipeline without checksum verification and security scanning"
      },
      {
        "file": "scripts/vulnerable-build.sh",
        "line_hint": "8",
        "vuln_type": "Supply Chain - Build",
        "severity_hint": "high",
        "note": "VULNERABLE: Build script fetching and executing remote scripts without verification"
      }
    ],
    "categories": {
      "SAST": [
        "SQL Injection",
        "Reflected XSS",
        "Insecure Deserialization",
        "Command Injection",
        "Unsafe eval()",
        "Weak Crypto - MD5",
        "Weak Crypto - DES",
        "Hardcoded Secrets"
      ],
      "DAST": [
        "Missing Authentication",
        "IDOR",
        "Missing Security Headers",
        "CORS Wide-Open",
        "Weak Session Management"
      ],
      "SCA": [
        "Vulnerable Dependencies"
      ],
      "Secrets": [
        "Secrets in Logs",
        "Secrets Exposure",
        "Hardcoded Secrets"
      ],
      "CSPM": [
        "Container Security",
        "Overly Permissive IAM",
        "Public Resources",
        "Missing Network Security"
      ],
      "Runtime": [
        "Debug Endpoints",
        "Privileged Containers",
        "Host Access"
      ],
      "Supply Chain": [
        "CI/CD Vulnerabilities",
        "Build Script Vulnerabilities"
      ]
    },
    "scanner_mapping": {
      "Aikido": {
        "SAST": "Static Application Security Testing",
        "DAST": "Dynamic Application Security Testing",
        "SCA": "Software Composition Analysis",
        "Secrets": "Secrets Scanning",
        "CSPM": "Cloud Security Posture Management",
        "Runtime": "Runtime Security Monitoring"
      }
    },
    "cve_packages": {
      "description": "Each CVE is now in its own package for AIKIDO to detect as separate concerns",
      "packages": [
        {
          "package": "agent.drive_thru.cve_packages.sql_injection",
          "cve_id": "CVE-2024-0001",
          "vulnerability_type": "SQL Injection",
          "severity": "High"
        },
        {
          "package": "agent.drive_thru.cve_packages.xss",
          "cve_id": "CVE-2024-0002",
          "vulnerability_type": "Reflected XSS",
          "severity": "Medium"
        },
        {
          "package": "agent.drive_thru.cve_packages.insecure_deserialization",
          "cve_id": "CVE-2024-0003",
          "vulnerability_type": "Insecure Deserialization",
          "severity": "Critical"
        },
        {
          "package": "agent.drive_thru.cve_packages.weak_crypto_md5",
          "cve_id": "CVE-2024-0004",
          "vulnerability_type": "Weak Crypto - MD5",
          "severity": "High"
        },
        {
          "package": "agent.drive_thru.cve_packages.weak_crypto_des",
          "cve_id": "CVE-2024-0005",
          "vulnerability_type": "Weak Crypto - DES",
          "severity": "High"
        },
        {
          "package": "agent.drive_thru.cve_packages.missing_authentication",
          "cve_id": "CVE-2024-0006",
          "vulnerability_type": "Missing Authentication",
          "severity": "High"
        },
        {
          "package": "agent.drive_thru.cve_packages.idor",
          "cve_id": "CVE-2024-0007",
          "vulnerability_type": "IDOR",
          "severity": "Medium"
        },
        {
          "package": "agent.drive_thru.cve_packages.command_injection",
          "cve_id": "CVE-2024-0008",
          "vulnerability_type": "Command Injection",
          "severity": "Critical"
        },
        {
          "package": "agent.drive_thru.cve_packages.unsafe_eval",
          "cve_id": "CVE-2024-0009",
          "vulnerability_type": "Unsafe eval()",
          "severity": "Critical"
        },
        {
          "package": "agent.drive_thru.cve_packages.hardcoded_secrets",
          "cve_id": "CVE-2024-0010",
          "vulnerability_type": "Hardcoded Secrets",
          "severity": "Critical"
        },
        {
          "package": "agent.drive_thru.cve_packages.secrets_exposure",
          "cve_id": "CVE-2024-0011",
          "vulnerability_type": "Secrets Exposure",
          "severity": "Critical"
        },
        {
          "package": "agent.drive_thru.cve_packages.missing_security_headers",
          "cve_id": "CVE-2024-0012",
          "vulnerability_type": "Missing Security Headers",
          "severity": "Medium"
        }
      ]
    }
  }
}
