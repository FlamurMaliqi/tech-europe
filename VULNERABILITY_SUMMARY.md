# VULNERABILITY LAB - COMPREHENSIVE SECURITY RISKS

## Overview
This vulnerability lab contains intentionally insecure configurations and code for educational purposes. **DO NOT USE IN PRODUCTION**.

## CRITICAL VULNERABILITIES

### 1. Infrastructure & Cloud Security (Terraform)
- **CloudTrail logging disabled** - No audit trail for AWS API calls
- **GuardDuty disabled** - No threat detection
- **Config rules disabled** - No compliance monitoring
- **KMS key with weak encryption** - No key rotation, weak key policy
- **Secrets Manager with weak configuration** - No rotation, immediate deletion
- **WAF disabled** - No web application firewall protection
- **VPC Flow Logs disabled** - No network traffic monitoring
- **S3 Buckets with public access** - No block public access globally
- **Firewall rules allow SSH from any public IP** - Overly permissive security groups
- **EC2 IAM roles vulnerable to SSRF attacks** - Overly permissive IAM policies
- **IAM Policy allows full administrative privileges** - Full AWS access
- **Deletion protection disabled for RDS database** - No data protection
- **IAM Policy has asterisks (*) in statement's allowed actions** - Overly permissive

### 2. Kubernetes Security
- **Dangerous Impersonate permission given to ServiceAccount** - Full cluster access
- **ServiceAccount or node can read all secrets** - No RBAC restrictions
- **Container running as root** - Privilege escalation risk
- **4 exposed secrets** - Hardcoded secrets in ConfigMap
- **Automatic upgrades of base Docker images** - Supply chain attack risk
- **Privileged container** - Full host access
- **Container processes can gain more privileges than parent** - Privilege escalation
- **Filesystem for docker container should not be writeable** - Data integrity risk
- **Default Kubernetes settings allow containers to eavesdrop on traffic** - Network security
- **Ingress with no TLS and weak security** - No encryption, no rate limiting
- **CronJob with privileged access** - Dangerous command execution
- **PersistentVolume with weak security** - No encryption, weak permissions
- **StatefulSet with weak security** - Privileged containers, no resource limits
- **HorizontalPodAutoscaler with no limits** - Resource exhaustion risk
- **PodDisruptionBudget with no protection** - No availability guarantees
- **ResourceQuota with no limits** - Resource exhaustion risk

### 3. Application Security (Python/FastAPI)
- **Advanced SQL injection vulnerabilities** - Dynamic queries, UNION injection, blind injection, error-based injection, stacked queries, second-order injection, filter bypass, database-specific injection, advanced payload injection
- **XXE (XML External Entity) vulnerabilities** - External entity references, file:// entities, http:// entities, parameter entities, blind XXE, SOAP XXE, SVG XXE, Office document XXE
- **SSRF (Server-Side Request Forgery) vulnerabilities** - Unrestricted HTTP requests, internal service requests, cloud metadata requests, file:// protocol requests, gopher:// protocol requests, ftp:// protocol requests, socket connections, Redis requests, Elasticsearch requests, MongoDB requests, blind SSRF, redirect SSRF, custom headers SSRF, POST data SSRF
- **Advanced Remote Code Execution vulnerabilities** - Shell command execution, Python code execution, eval expression execution, compile code execution, pickle deserialization, marshal deserialization, dynamic module import, file operations, network operations, system commands, popen commands, template injection, LDAP injection, NoSQL injection, advanced payload execution
- **Advanced Insecure Deserialization vulnerabilities** - Pickle deserialization, marshal deserialization, JSON deserialization, YAML deserialization, XML deserialization, base64 deserialization, compressed deserialization, custom format deserialization, nested deserialization
- **Advanced Path Traversal vulnerabilities** - File read with traversal, file write with traversal, file deletion with traversal, directory listing with traversal, file copy with traversal, file move with traversal, directory creation with traversal, directory removal with traversal, file info with traversal, file execution with traversal
- **SQL injection via string-based query concatenation** - Direct SQL execution
- **Unsafe eval usage** - Remote code execution
- **Possible command injection via shell script** - Command execution
- **Identified a generic password field** - Weak password handling
- **8 exposed secrets** - Hardcoded secrets in code
- **Reflected XSS** - No input sanitization
- **IDOR (Insecure Direct Object Reference)** - No authorization checks
- **Weak crypto** - MD5 hashing, weak encryption
- **Missing authentication** - No admin authentication
- **Secrets exposure** - Debug endpoints expose all secrets
- **Arbitrary module import** - Dynamic import vulnerabilities
- **Unsafe exec usage** - Code execution
- **Unsafe compile usage** - Code compilation
- **Unsafe deserialization** - Pickle/JSON deserialization
- **Unsafe serialization** - Data serialization
- **Unsafe reflection** - Object reflection
- **Globals exposure** - Global variables access
- **Locals exposure** - Local variables access
- **Directory traversal** - File system access
- **Arbitrary file read** - File access
- **Arbitrary file write** - File modification

### 4. Container Security (Docker)
- **Docker container configured to run as user with root privileges** - Privilege escalation
- **SSH server with weak configuration** - Root login enabled
- **Weak user accounts** - Predictable passwords
- **Weak file permissions** - 777 permissions on sensitive files
- **No health checks** - No container health monitoring
- **No resource limits** - Resource exhaustion risk
- **No security scanning** - No vulnerability scanning
- **No secrets management** - Hardcoded secrets
- **No network isolation** - No network security
- **No user namespace isolation** - No user isolation
- **No capabilities dropping** - Full capabilities
- **No read-only root filesystem** - Writable root filesystem
- **No security profiles** - No security policies
- **No image scanning** - No image vulnerability scanning
- **No multi-stage build** - No build optimization
- **No .dockerignore** - No build context optimization
- **No image signing** - No image integrity
- **No vulnerability scanning** - No security scanning
- **No compliance scanning** - No compliance monitoring

### 5. Package Vulnerabilities (Python)
- **pycrypto** - Memory corruption, operation restrictions
- **pillow** - Memory corruption leading to crash or RCE
- **django** - SQL injection attack possible
- **setuptools** - Code injection attack possible
- **jinja2** - Missing or insufficient protection mechanisms
- **urllib3** - Accidental exposure of sensitive info possible

## HIGH VULNERABILITIES

### 1. Application Security
- **flask** - Various security issues
- **tornado** - DoS attack possible
- **lxml** - DoS or RCE possible due to NULL pointer dereference
- **cryptography** - DoS or RCE possible due to NULL pointer dereference
- **celery** - Code injection attack possible
- **requests** - Accidental exposure of sensitive info possible
- **paramiko** - Various security issues

### 2. Infrastructure
- **Docker container configured to run as user with root privileges**
- **Filesystem for docker container should not be writeable**
- **Privileged container can allow attackers to escalate attacks**
- **Container processes can gain more privileges than its parent**
- **8 exposed secrets** - Hardcoded secrets in configuration files

## MEDIUM VULNERABILITIES

### 1. Application Security
- **pydantic** - DoS attack possible via regex
- **pip** - Missing input validation
- **numpy** - Buffer overflow leading to crash or RCE

### 2. Infrastructure
- **IAM Policy allows full administrative privileges**
- **Deletion protection is disabled for RDS database**
- **IAM Policy has asterisks (*) in statement's allowed actions**
- **Default Kubernetes settings allow containers to eavesdrop on traffic**

### 3. Configuration Management
- **No configuration validation** - No input validation
- **No configuration encryption** - No data encryption
- **No configuration access control** - No access control
- **No environment variable validation** - No validation
- **No logging configuration validation** - No validation
- **No cache configuration validation** - No validation
- **No session configuration validation** - No validation
- **No database configuration validation** - No validation
- **No API configuration validation** - No validation
- **No security configuration validation** - No validation
- **No monitoring configuration validation** - No validation

### 4. Network Security
- **No SSL verification** - No certificate validation
- **No firewall rule validation** - No validation
- **No proxy configuration validation** - No validation
- **No DNS configuration validation** - No validation
- **No load balancer configuration validation** - No validation
- **No network monitoring validation** - No validation
- **No security policy validation** - No validation

## LOW VULNERABILITIES

### 1. Logging & Monitoring
- **No logging configuration validation** - No validation
- **No error handling validation** - No validation
- **No performance monitoring validation** - No validation
- **No health check validation** - No validation
- **No metrics collection validation** - No validation
- **No alerting validation** - No validation
- **No audit logging validation** - No validation

### 2. Utility Functions
- **No file utility validation** - No validation
- **No archive utility validation** - No validation
- **No data processing validation** - No validation
- **No string utility validation** - No validation
- **No validation utility validation** - No validation
- **No cache utility validation** - No validation

### 3. Package Vulnerabilities
- **pytz** - Various security issues
- **six** - Various security issues
- **wheel** - Various security issues

## SECURITY CATEGORIES COVERED

1. **Infrastructure Security**
   - Cloud security misconfigurations
   - Container security issues
   - Kubernetes security problems
   - Network security vulnerabilities

2. **Application Security**
   - Injection vulnerabilities (SQL, Command, Code)
   - Authentication and authorization issues
   - Input validation problems
   - Cryptographic weaknesses
   - Session management issues

3. **Data Security**
   - Secrets management problems
   - Data encryption issues
   - Data validation problems
   - Data access control issues

4. **Network Security**
   - SSL/TLS configuration problems
   - Firewall misconfigurations
   - Network monitoring issues
   - Proxy configuration problems

5. **Operational Security**
   - Logging and monitoring issues
   - Error handling problems
   - Performance monitoring issues
   - Health check problems

6. **Package Security**
   - Vulnerable dependencies
   - Outdated packages
   - Known CVEs in dependencies

7. **Email Security**
   - SMTP configuration issues
   - Email validation problems
   - Email encryption weaknesses
   - Email filtering vulnerabilities

8. **Payment Processing Security**
   - Payment validation issues
   - Credit card processing vulnerabilities
   - Payment gateway security problems
   - Fraud detection weaknesses

9. **File Upload Security**
   - File validation problems
   - File compression vulnerabilities
   - File sharing security issues
   - File metadata extraction problems

10. **Session Management Security**
    - Session validation issues
    - Session storage vulnerabilities
    - Session security problems
    - Session analytics weaknesses

11. **Rate Limiting Security**
    - Rate limiting validation issues
    - API throttling vulnerabilities
    - API monitoring problems
    - API security weaknesses

12. **Data Validation Security**
    - Input validation problems
    - Data sanitization issues
    - Validation rule vulnerabilities
    - Custom validator weaknesses

13. **Configuration Management Security**
    - Configuration validation issues
    - Environment variable problems
    - Logging configuration vulnerabilities
    - Cache configuration weaknesses

14. **Network Security (Extended)**
    - SSL context problems
    - Firewall configuration issues
    - Proxy configuration vulnerabilities
    - DNS configuration weaknesses

15. **Logging & Monitoring Security**
    - Logging validation issues
    - Error handling problems
    - Performance monitoring vulnerabilities
    - Health check weaknesses

16. **Utility Functions Security**
    - File utility vulnerabilities
    - Archive utility problems
    - Data processing issues
    - String utility weaknesses

17. **Package Vulnerabilities (Extended)**
    - Email & Communication packages
    - Payment Processing packages
    - File Processing packages
    - Session Management packages
    - Rate Limiting packages
    - Data Validation packages
    - Utilities packages
    - Date/Time packages
    - Text Processing packages
    - Image Processing packages
    - Audio Processing packages
    - Video Processing packages
    - Network packages
    - Web Scraping packages
    - Testing packages
    - Documentation packages
    - Development Tools packages
    - Configuration packages
    - Logging packages
    - Caching packages
    - Serialization packages
    - Compression packages
    - Hashing packages
    - Regular Expressions packages
    - File System packages
    - System packages
    - Math & Statistics packages
    - Collections packages

## DETECTION METHODS

These vulnerabilities can be detected by:
- Static Application Security Testing (SAST)
- Dynamic Application Security Testing (DAST)
- Infrastructure as Code (IaC) scanning
- Container image scanning
- Dependency scanning
- Network vulnerability scanning
- Configuration auditing
- Compliance scanning

## REMEDIATION RECOMMENDATIONS

1. **Implement proper authentication and authorization**
2. **Use parameterized queries to prevent SQL injection**
3. **Implement input validation and sanitization**
4. **Use strong cryptographic algorithms**
5. **Implement proper secrets management**
6. **Use least privilege access principles**
7. **Implement proper logging and monitoring**
8. **Use secure configuration management**
9. **Implement proper network security**
10. **Keep dependencies updated and scan for vulnerabilities**

## WARNING

**THIS IS A VULNERABILITY LAB FOR EDUCATIONAL PURPOSES ONLY**
**DO NOT USE ANY OF THESE CONFIGURATIONS IN PRODUCTION**
**ALL VULNERABILITIES ARE INTENTIONALLY INTRODUCED FOR LEARNING**
